  0%|          | 0/49 [00:00<?, ?it/s]Extracting : brotlipy-0.7.0-py310h7f8727e_1002.conda:   0%|          | 0/49 [00:00<?, ?it/s]Extracting : brotlipy-0.7.0-py310h7f8727e_1002.conda:   2%|â–         | 1/49 [00:00<00:08,  5.79it/s]Extracting : zstandard-0.19.0-py310h5eee18b_0.conda:   2%|â–         | 1/49 [00:00<00:08,  5.79it/s] Extracting : toolz-0.12.0-py310h06a4308_0.conda:   4%|â–         | 2/49 [00:00<00:08,  5.79it/s]    Extracting : packaging-23.0-py310h06a4308_0.conda:   6%|â–Œ         | 3/49 [00:00<00:07,  5.79it/s]Extracting : tk-8.6.12-h1ccaba5_0.conda:   8%|â–Š         | 4/49 [00:00<00:07,  5.79it/s]          Extracting : tk-8.6.12-h1ccaba5_0.conda:  10%|â–ˆ         | 5/49 [00:00<00:02, 19.46it/s]Extracting : wheel-0.38.4-py310h06a4308_0.conda:  10%|â–ˆ         | 5/49 [00:00<00:02, 19.46it/s]Extracting : conda-23.3.1-py310h06a4308_0.conda:  12%|â–ˆâ–        | 6/49 [00:00<00:02, 19.46it/s]Extracting : _libgcc_mutex-0.1-main.conda:  14%|â–ˆâ–        | 7/49 [00:00<00:02, 19.46it/s]      Extracting : conda-package-streaming-0.7.0-py310h06a4308_0.conda:  16%|â–ˆâ–‹        | 8/49 [00:00<00:02, 19.46it/s]Extracting : ruamel.yaml.clib-0.2.6-py310h5eee18b_1.conda:  18%|â–ˆâ–Š        | 9/49 [00:00<00:02, 19.46it/s]       Extracting : _openmp_mutex-5.1-1_gnu.conda:  20%|â–ˆâ–ˆ        | 10/49 [00:00<00:02, 19.46it/s]              Extracting : xz-5.2.10-h5eee18b_1.conda:  22%|â–ˆâ–ˆâ–       | 11/49 [00:00<00:01, 19.46it/s]   Extracting : conda-package-handling-2.0.2-py310h06a4308_0.conda:  24%|â–ˆâ–ˆâ–       | 12/49 [00:00<00:01, 19.46it/s]Extracting : openssl-1.1.1t-h7f8727e_0.conda:  27%|â–ˆâ–ˆâ–‹       | 13/49 [00:00<00:01, 19.46it/s]                   Extracting : cryptography-39.0.1-py310h9ce1e76_0.conda:  29%|â–ˆâ–ˆâ–Š       | 14/49 [00:00<00:01, 19.46it/s]Extracting : sqlite-3.41.1-h5eee18b_0.conda:  31%|â–ˆâ–ˆâ–ˆ       | 15/49 [00:00<00:01, 19.46it/s]           Extracting : ncurses-6.4-h6a678d5_0.conda:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 16/49 [00:00<00:01, 19.46it/s]  Extracting : ncurses-6.4-h6a678d5_0.conda:  35%|â–ˆâ–ˆâ–ˆâ–      | 17/49 [00:00<00:00, 33.06it/s]Extracting : ruamel.yaml-0.17.21-py310h5eee18b_0.conda:  35%|â–ˆâ–ˆâ–ˆâ–      | 17/49 [00:00<00:00, 33.06it/s]Extracting : pysocks-1.7.1-py310h06a4308_0.conda:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 18/49 [00:00<00:00, 33.06it/s]      Extracting : pycparser-2.21-pyhd3eb1b0_0.conda:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 19/49 [00:00<00:00, 33.06it/s]  Extracting : urllib3-1.26.15-py310h06a4308_0.conda:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/49 [00:00<00:00, 33.06it/s]Extracting : cffi-1.15.1-py310h5eee18b_3.conda:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 21/49 [00:00<00:00, 33.06it/s]    Extracting : pycosat-0.6.4-py310h5eee18b_0.conda:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/49 [00:00<00:00, 33.06it/s]Extracting : libstdcxx-ng-11.2.0-h1234567_1.conda:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 23/49 [00:00<00:00, 33.06it/s]Extracting : pip-23.0.1-py310h06a4308_0.conda:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 24/49 [00:00<00:00, 33.06it/s]    Extracting : libgcc-ng-11.2.0-h1234567_1.conda:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/49 [00:00<00:00, 33.06it/s]Extracting : jsonpatch-1.32-pyhd3eb1b0_0.conda:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 26/49 [00:00<00:00, 33.06it/s]Extracting : six-1.16.0-pyhd3eb1b0_1.conda:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 27/49 [00:00<00:00, 33.06it/s]    Extracting : readline-8.2-h5eee18b_0.conda:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 28/49 [00:00<00:00, 33.06it/s]Extracting : libuuid-1.41.5-h5eee18b_0.conda:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 29/49 [00:00<00:00, 33.06it/s]Extracting : requests-2.28.1-py310h06a4308_1.conda:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/49 [00:00<00:00, 33.06it/s]Extracting : tqdm-4.65.0-py310h2f386ee_0.conda:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 31/49 [00:00<00:00, 33.06it/s]    Extracting : tzdata-2023c-h04d1e81_0.conda:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 32/49 [00:00<00:00, 33.06it/s]    Extracting : jsonpointer-2.1-pyhd3eb1b0_0.conda:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 33/49 [00:00<00:00, 33.06it/s]Extracting : idna-3.4-py310h06a4308_0.conda:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 34/49 [00:00<00:00, 33.06it/s]    Extracting : python-3.10.10-h7a1cb2a_2.conda:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 35/49 [00:00<00:00, 33.06it/s]Extracting : python-3.10.10-h7a1cb2a_2.conda:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 36/49 [00:00<00:00, 53.91it/s]Extracting : libgomp-11.2.0-h1234567_1.conda:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 36/49 [00:00<00:00, 53.91it/s]Extracting : zlib-1.2.13-h5eee18b_0.conda:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 37/49 [00:00<00:00, 53.91it/s]   Extracting : boltons-23.0.0-py310h06a4308_0.conda:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 38/49 [00:00<00:00, 53.91it/s]Extracting : pyopenssl-23.0.0-py310h06a4308_0.conda:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 39/49 [00:00<00:00, 53.91it/s]Extracting : bzip2-1.0.8-h7b6447c_0.conda:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 40/49 [00:00<00:00, 53.91it/s]          Extracting : certifi-2022.12.7-py310h06a4308_0.conda:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 41/49 [00:00<00:00, 53.91it/s]Extracting : ca-certificates-2023.01.10-h06a4308_0.conda:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 42/49 [00:00<00:00, 53.91it/s]Extracting : conda-content-trust-0.1.3-py310h06a4308_0.conda:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 43/49 [00:00<00:00, 53.91it/s]Extracting : charset-normalizer-2.0.4-pyhd3eb1b0_0.conda:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 44/49 [00:00<00:00, 53.91it/s]    Extracting : libffi-3.4.2-h6a678d5_6.conda:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 45/49 [00:00<00:00, 53.91it/s]              Extracting : setuptools-65.6.3-py310h06a4308_0.conda:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/49 [00:00<00:00, 53.91it/s]Extracting : ld_impl_linux-64-2.38-h1181459_1.conda:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 47/49 [00:00<00:00, 53.91it/s] Extracting : pluggy-1.0.0-py310h06a4308_1.conda:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 48/49 [00:00<00:00, 53.91it/s]                                                                                                    wandb: Appending key for api.wandb.ai to your netrc file: /var/lib/condor/execute/slot1/dir_2234293/.netrc
wandb: Currently logged in as: jackcai1206. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /var/lib/condor/execute/slot1/dir_2234293/Training-Looped-Transformers/scripts/wandb/run-20230622_121033-xqn5vmnc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wobbly-brook-113
wandb: â­ï¸ View project at https://wandb.ai/jackcai1206/training-looped-transformers
wandb: ðŸš€ View run at https://wandb.ai/jackcai1206/training-looped-transformers/runs/xqn5vmnc
Traceback (most recent call last):
  File "/var/lib/condor/execute/slot1/dir_2234293/Training-Looped-Transformers/scripts/../main.py", line 559, in <module>
    main(args, checkpoint)
  File "/var/lib/condor/execute/slot1/dir_2234293/Training-Looped-Transformers/scripts/../main.py", line 435, in main
    val_loss, val_acc = evaluate(model, step, eval_loader, criterion, test_sim, args)
  File "/var/lib/condor/execute/slot1/dir_2234293/Training-Looped-Transformers/scripts/../main.py", line 147, in evaluate
    output = model(data)
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1212, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/var/lib/condor/execute/slot1/dir_2234293/Training-Looped-Transformers/model/model.py", line 91, in forward
    src = self.encoder(src)
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 160, in forward
    return F.embedding(
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1024.00 MiB (GPU 0; 79.33 GiB total capacity; 115.02 MiB already allocated; 1.31 MiB free; 196.00 MiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: ðŸš€ View run wobbly-brook-113 at: https://wandb.ai/jackcai1206/training-looped-transformers/runs/xqn5vmnc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230622_121033-xqn5vmnc/logs
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2249366) of binary: /var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/bin/python
Traceback (most recent call last):
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.13.1', 'console_scripts', 'torchrun')())
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/distributed/run.py", line 762, in main
    run(args)
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/var/lib/condor/execute/slot1/dir_2234293/miniconda3/envs/loop-trans/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
../main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-06-22_12:12:25
  host      : gpu2009.chtc.wisc.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2249366)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
